{
  "server": {
    "listen_addr": ":8080",
    "api_listen_addr": ":8443",
    "multi_app_mode": false,
    "app_id_header": "X-App-ID",
    "app_id_fallback": "default",
    "proxy_target": "http://localhost:80",
    "tls": {
      "enabled": true,
      "cert_file": "/app/config/certs/server.crt",
      "key_file": "/app/config/certs/server.key"
    }
  },
  "database": {
    "type": "sqlite",
    "sqlite": {
      "path": "./data/ifrit.db",
      "journal_mode": "WAL",
      "synchronous": "NORMAL"
    },
    "mysql": {
      "host": "localhost",
      "port": 3306,
      "username": "ifrit_user",
      "password": "${DB_PASSWORD}",
      "database": "ifrit",
      "max_connections": 20,
      "ssl": false
    },
    "postgresql": {
      "host": "localhost",
      "port": 5432,
      "username": "ifrit_user",
      "password": "${DB_PASSWORD}",
      "database": "ifrit",
      "ssl_mode": "disable",
      "max_connections": 20
    },
    "connection_pool": {
      "enabled": true,
      "max_idle_connections": 5,
      "max_open_connections": 25,
      "connection_max_lifetime": "1h"
    }
  },
  "apps": {
    "app1": {
      "proxy_target": "http://localhost:3000",
      "enabled": true,
      "description": "Main API"
    },
    "app2": {
      "proxy_target": "http://localhost:4000",
      "enabled": true,
      "description": "Admin Panel"
    }
  },
  "api": {
    "listen_addr": ":8443",
    "authentication": {
      "enabled": true,
      "token_header": "X-API-Token",
      "require_auth": true,
      "token_expiry_days": 90
    },
    "rate_limiting": {
      "enabled": true,
      "requests_per_minute": 100
    }
  },
  "dashboard": {
    "enabled": true,
    "listen_addr": ":5601",
    "authentication": {
      "enabled": true,
      "token_header": "X-Dashboard-Token"
    }
  },
  "llm": {
    "primary": "claude",
    "claude": {
      "api_key": "${CLAUDE_API_KEY}",
      "model": "claude-3-5-haiku-20241022"
    },
    "gpt": {
      "api_key": "${OPENAI_API_KEY}",
      "model": "gpt-4o-mini"
    }
  },
  "detection": {
    "mode": "detection",
    "enable_local_rules": true,
    "enable_llm": true,
    "llm_only_on": ["GET", "POST", "PUT", "DELETE"],
    "whitelist_ips": [],
    "whitelist_paths": [],
    "skip_body_check_on_whitelist": true
  },
  "execution_mode": {
    "mode": "detection",
    "onboarding_auto_whitelist": true,
    "onboarding_duration_days": 7,
    "onboarding_log_file": "./logs/onboarding_traffic.log"
  },
  "anonymization": {
    "enabled": true,
    "strategy": "hybrid",
    "store_original": true,
    "sensitive_headers": ["Authorization", "Cookie", "X-API-Key", "X-Auth-Token"]
  },
  "payload_management": {
    "enable_intel_collection": true,
    "intel_collection_payload_id": 1,
    "cache_llm_payloads_to_db": true,
    "generate_dynamic_payload": true,
    "dynamic_llm_cache_ttl": 86400,
    "use_db_payloads": true,
    "default_responses": {
      "reconnaissance": {
        "content": {"error": "Not found"},
        "status_code": 404
      },
      "sql_injection": {
        "content": {"error": "Forbidden"},
        "status_code": 403
      },
      "xss": {
        "content": {"error": "Invalid input", "message": "XSS prevention enabled"},
        "status_code": 400
      },
      "credential_stuffing": {
        "content": {"error": "Invalid credentials", "message": "Account locked after 3 attempts"},
        "status_code": 401
      },
      "blocked_by_allowlist": {
        "content": {"error": "Forbidden"},
        "status_code": 403
      },
      "fallback": {
        "content": {"error": "Internal server error"},
        "status_code": 500
      }
    }
  },
  "system": {
    "home_dir": "./",
    "log_dir": "./logs",
    "log_level": "info",
    "debug": false
  },
  "threat_intelligence": {
    "enabled": true,
    "cache_ttl_hours": 24,
    "enrichment_workers": 3,
    "apis": {
      "abuseipdb": {
        "enabled": true,
        "api_key": "${ABUSEIPDB_API_KEY}",
        "timeout_seconds": 10
      },
      "virustotal": {
        "enabled": true,
        "api_key": "${VIRUSTOTAL_API_KEY}",
        "timeout_seconds": 10
      },
      "ipinfo": {
        "enabled": true,
        "api_key": "${IPINFO_API_KEY}",
        "timeout_seconds": 10
      }
    },
    "risk_score_weights": {
      "abuseipdb_score": 0.4,
      "virustotal_detections": 0.35,
      "ipinfo_risk": 0.25
    },
    "threat_level_thresholds": {
      "critical": 80,
      "high": 60,
      "medium": 40,
      "low": 0
    }
  },
  "notifications": {
    "enabled": true,
    "providers": {
      "email": {
        "enabled": false,
        "smtp_host": "smtp.gmail.com",
        "smtp_port": 587,
        "smtp_username": "${SMTP_USERNAME}",
        "smtp_password": "${SMTP_PASSWORD}",
        "from_address": "alerts@ifrit.local"
      },
      "slack": {
        "enabled": false,
        "webhook_url": "${SLACK_WEBHOOK_URL}"
      },
      "twilio": {
        "enabled": false,
        "account_sid": "${TWILIO_ACCOUNT_SID}",
        "auth_token": "${TWILIO_AUTH_TOKEN}",
        "from_number": "${TWILIO_FROM_NUMBER}",
        "to_number": "${TWILIO_TO_NUMBER}"
      }
    },
    "rules": {
      "alert_on_critical": true,
      "alert_on_high": false,
      "alert_on_medium": false,
      "alert_on_low": false
    }
  },
  "webhooks": {
    "enabled": true,
    "retry_count": 3,
    "retry_delay_seconds": 5,
    "timeout_seconds": 10
  }
}
